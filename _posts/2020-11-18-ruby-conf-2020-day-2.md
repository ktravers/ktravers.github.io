---
layout: post
title: Notes from RubyConf2020 Day 2
---

## Keynote: Kerri Miller

"If you can move it, it isn't broken"




## Demonstration: Making a ractor (Koichi Sasada)

[Ractor](https://github.com/ruby/ruby/blob/master/doc/ractor.md) is an experimental feature in Ruby 3.0

> Ractor is designed to provide a parallel execution feature of Ruby without thread-safety concerns.

Performance:  
- Object creation on ractors is slower, needs improvement before GA.

Limited object sharing:  
- Most objects are not shared among multiple Ractors
- Avoid synchronization bugs
- However there are immutable objects and "special shared objects"

Communication types:  
- In general, message passing on incoming- and outgoing- ports
- Supports push / Actor style communication
- Supports pull / rendezvous style communication
- Send objects via message passing by copy or move

Demos:  
- Ractor-based "load balancer"
- Ractor-based worker pool
- Pipeline

Summary:  
- Ractor provides parallel execution without thread-safety headaches
- Part of Ruby 3.0
- Ractor API and implementation is not mature
  - Ruby 3.0 is the preview release
  - Feedback welcome

## The Bug That Forced Me to Understand Memory Compaction (Emily Giurleo)

_Note: I dropped in late because I already caught an early version of this talk at nyc.rb_

This bug hunt story is specific to Ruby gem with C extension

Takeaways:  
- Knowledge sharing is crucial
- You never know when the knowledge you put in the world will help someone out of a huge jam like this one, so just put it out there!

Summary:  
- Ruby 2.7 includes manual memory compaction
- When maintaining an existing gem with C extension, maually mark long-lived objects and refs
- Newer C extensions can use new convenience methods for pinning and marking objects
