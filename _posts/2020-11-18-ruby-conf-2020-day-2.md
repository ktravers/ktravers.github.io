---
layout: post
title: Notes from RubyConf2020 Day 2
---

## Keynote: Kerri Miller

"If you can move it, it isn't broken"

New item for the bucket list: "The 1000 mile stomachache" roadtrip

Learnings from a cross-country motorcycle trip:  
- Ambition
- Failure
- Resilience
- Storytelling

When something bad happens, "at least you get a story out of it"  
- True for motorcycle accidents and code
- Be resilient
- Opportunity to learn and help others
- The story you tell yourself about failures is important

Ambitious systems:  
- Multidisciplinary
- Large and complicated
  - Too large for one team to fully understand
- Success breeds essentiality
- Undefinable end state
  - How do you know when you're done?
  - What does success look like?
  - Ignore complexity for speed
  - All systems without a well-defined end state will bend towards complexity and chaos

Dwarf Fortress example:  
- Dev ships new "tavern" feature
- Then bug report comes in: "There's cat vomit all over my tavern" (??)
- Design bugs can be subtle, easy to miss and make mistakes

Good quotes:  
- "Software is the resolution of the argument between the proactive and the pragmatic"
- "The most dangerous thought you can have as a creative person is to think you know what you're doing" (Bret Victor)
- "Code is inherently incorrect. It's always in a state of undiscovered failure"

Why are we so resistent to change?  
- We want to be right
- Risk being vulnerable
- Risk our professional reputation
- Risk our self-image ("Do I know what I'm doing?")


## Demonstration: Making a ractor (Koichi Sasada)

[Ractor](https://github.com/ruby/ruby/blob/master/doc/ractor.md) is an experimental feature in Ruby 3.0

> Ractor is designed to provide a parallel execution feature of Ruby without thread-safety concerns.

Performance:  
- Object creation on ractors is slower, needs improvement before GA.

Limited object sharing:  
- Most objects are not shared among multiple Ractors
- Avoid synchronization bugs
- However there are immutable objects and "special shared objects"

Communication types:  
- In general, message passing on incoming- and outgoing- ports
- Supports push / Actor style communication
- Supports pull / rendezvous style communication
- Send objects via message passing by copy or move

Demos:  
- Ractor-based "load balancer"
- Ractor-based worker pool
- Pipeline

Summary:  
- Ractor provides parallel execution without thread-safety headaches
- Part of Ruby 3.0
- Ractor API and implementation is not mature
  - Ruby 3.0 is the preview release
  - Feedback welcome

## The Bug That Forced Me to Understand Memory Compaction (Emily Giurleo)

_Note: I dropped in late because I already caught an early version of this talk at nyc.rb_

[Slides](https://docs.google.com/presentation/d/1VmJyyM9dY5clrlCj8hkzkQY8DYZYM-HGYIBl5JAhUhU/edit#slide=id.p)

This bug hunt story is specific to Ruby gem with C extension.

Takeaways:  
- Knowledge sharing is crucial
- You never know when the knowledge you put in the world will help someone out of a huge jam like this one, so just put it out there!

Summary:  
- Ruby 2.7 includes manual memory compaction
- When maintaining an existing gem with C extension, maually mark long-lived objects and refs
- Newer C extensions can use new convenience methods for pinning and marking objects

## Storytelling and Talent Show


